{
    "type": "bundle",
    "id": "bundle--03b0d2cc-6b10-4a3a-b0c8-d9130729dbf4",
    "spec_version": "2.0",
    "objects": [
        {
            "type": "relationship",
            "id": "relationship--a6bc65f9-30c8-4f55-b4ce-049afdb3255b",
            "created": "2022-03-30T14:26:51.857Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "revoked": false,
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "modified": "2023-03-27T17:54:15.564Z",
            "description": "Monitor processes and command-line arguments for actions that could be taken to change, conceal, and/or delete information in the Registry. (i.e. reg.exe, regedit.exe) \n\n<h4> Implementation 1 : Suspicious Processes </h4>\n\n<h5> Detection Pseudocode</h5>\n<code>reg_processes = filter processes where ( \n  (event_id == \"1\" OR event_id == \"4688\") AND (exe == \"reg.exe\" AND parent_exe == \"cmd.exe\")\n)\ncmd_processes = filter processes where ( \n  (event_id == \"1\" OR event_id == \"4688\") AND (exe == \"cmd.exe\" AND parent_exe != \"explorer.exe\"\")\n)\nreg_and_cmd_processes = join (reg_processes, cmd_processes) where (reg.parent_pid == cmd.pid and reg.hostname == cmd.hostname)</code>\n\n<h4>Detection Notes </h4>\n\n- Pseudocode Event IDs are for Sysmon (Event ID 1 - process create) and Windows Security Log (Event ID 4688 - a new process has been created). \n- The Detection Pseudocode is oriented around detecting invocations of [Reg](https://attack.mitre.org/software/S0075) where the parent executable is an instance of cmd.exe that wasn\u2019t spawned by explorer.exe. The built-in utility\u00a0reg.exe provides a\u00a0command-line interface to the registry, so that queries and modifications can be performed from a shell, such as\u00a0cmd.exe. When a user is responsible for these actions, the parent of\u00a0cmd.exewill typically be\u00a0explorer.exe. Occasionally, power users and administrators write scripts that do this behavior as well, but likely from a different process tree. These background scripts must be baselined so they can be tuned out accordingly.",
            "relationship_type": "detects",
            "source_ref": "x-mitre-data-component--3d20385b-24ef-40e1-9f56-f39750379077",
            "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4",
            "x_mitre_deprecated": false,
            "x_mitre_version": "0.1",
            "x_mitre_attack_spec_version": "3.1.0",
            "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        }
    ]
}