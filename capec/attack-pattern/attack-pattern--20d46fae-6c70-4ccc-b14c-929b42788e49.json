{
    "type": "attack-pattern",
    "id": "attack-pattern--20d46fae-6c70-4ccc-b14c-929b42788e49",
    "created_by_ref": "identity--8f6c4831-6b8a-469b-b654-9dcaeede2d35",
    "created": "2018-03-06T15:56:00.760Z",
    "modified": "2018-03-06T15:56:00.760Z",
    "name": "SQL Injection through SOAP Parameter Tampering",
    "description": "An attacker modifies the parameters of the SOAP message that is sent from the service consumer to the service provider to initiate a SQL injection attack. On the service provider side, the SOAP message is parsed and parameters are not properly validated before being used to access a database in a way that does not use parameter binding, thus enabling the attacker to control the structure of the executed SQL query. This pattern describes a SQL injection attack with the delivery mechanism being a SOAP message.",
    "external_references": [
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/110.html",
            "external_id": "CAPEC-110"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/89.html",
            "external_id": "CWE-89"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/20.html",
            "external_id": "CWE-20"
        }
    ],
    "object_marking_refs": [
        "marking-definition--aee86263-8856-421f-b382-457d8408db7d"
    ],
    "x_capec_abstraction": "Detailed",
    "x_capec_consequences": {
        "Run Arbitrary Code": "Execute unauthorized code or commands"
    },
    "x_capec_example_instances": [
        "An attacker uses a travel booking system that leverages SOAP communication between the client and the travel booking service. An attacker begins to tamper with the outgoing SOAP messages by modifying their parameters to include characters that would break a dynamically constructed SQL query. He notices that the system fails to respond when these malicious inputs are injected in certain parameters transferred in a SOAP message. The attacker crafts a SQL query that modifies his payment amount in the travel system's database and passes it as one of the parameters . A backend batch payment system later fetches the payment amount from the database (the modified payment amount) and sends to the credit card processor, enabling the attacker to purchase the airfare at a lower price. An attacker needs to have some knowledge of the system's database, perhaps by exploiting another weakness that results in information disclosure."
    ],
    "x_capec_likelihood_of_attack": "High",
    "x_capec_prerequisites": [
        "SOAP messages are used as a communication mechanism in the system",
        "SOAP parameters are not properly validated at the service provider",
        "The service provider does not properly utilize parameter binding when building SQL queries"
    ],
    "x_capec_skills_required": {
        "If the attacker has to perform SQL injection blindly": "High",
        "If the attacker is able to gain good understanding of the system's database schema": "Medium"
    },
    "x_capec_typical_severity": "Very High",
    "x_resources_required": "None: No specialized resources are required to execute this type of attack."
}