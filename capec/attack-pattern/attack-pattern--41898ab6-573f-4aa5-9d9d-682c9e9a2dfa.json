{
    "type": "attack-pattern",
    "id": "attack-pattern--41898ab6-573f-4aa5-9d9d-682c9e9a2dfa",
    "created_by_ref": "identity--8f6c4831-6b8a-469b-b654-9dcaeede2d35",
    "created": "2018-03-06T15:56:02.180Z",
    "modified": "2018-03-06T15:56:02.180Z",
    "name": "Generic Cross-Browser Cross-Domain Theft",
    "description": "An attacker makes use of Cascading Style Sheets (CSS) injection to steal data cross domain from the victim's browser. The attack works by abusing the standards relating to loading of CSS: 1. Send cookies on any load of CSS (including cross-domain) 2. When parsing returned CSS ignore all data that does not make sense before a valid CSS descriptor is found by the CSS parser\nBy having control of some text in the victim's domain, the attacker is able to inject a seemingly valid CSS string. It does not matter if this CSS string is preceded by other data. The CSS parser will still locate the CSS string.\nIf the attacker is able to control two injection points, one before the cross domain data that the attacker is interested in receiving and the other one after, the attacker can use this attack to steal all of the data in between these two CSS injection points when referencing the injected CSS while performing rendering on the site that the attacker controls. When rendering, the CSS parser will detect the valid CSS string to parse and ignore the data that \"does not make sense\". That data will simply be rendered. That data is in fact the data that the attacker just stole cross domain.\nThe stolen data may contain sensitive information, such CSRF protection tokens.",
    "external_references": [
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/468.html",
            "external_id": "CAPEC-468"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/707.html",
            "external_id": "CWE-707"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/149.html",
            "external_id": "CWE-149"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/177.html",
            "external_id": "CWE-177"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/838.html",
            "external_id": "CWE-838"
        }
    ],
    "object_marking_refs": [
        "marking-definition--aee86263-8856-421f-b382-457d8408db7d"
    ],
    "x_capec_abstraction": "Standard",
    "x_capec_prerequisites": [
        "No new lines can be present in the injected CSS string\nProper HTML or URL escaping of the \" and ' characters is not present\nThe attacker has control of two injection points: pre-string and post-string"
    ],
    "x_capec_skills_required": {
        "Ability to craft a CSS injection": "High"
    },
    "x_capec_typical_severity": "Medium",
    "x_resources_required": "Attacker controlled site/page to render a page referencing the injected CSS string"
}