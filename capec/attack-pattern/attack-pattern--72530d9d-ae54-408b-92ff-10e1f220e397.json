{
    "type": "attack-pattern",
    "id": "attack-pattern--72530d9d-ae54-408b-92ff-10e1f220e397",
    "created_by_ref": "identity--d922e967-ff9b-4f27-97e6-2fc5f54aac51",
    "created": "2018-03-05T19:06:11.944Z",
    "modified": "2018-03-05T19:06:11.944Z",
    "name": "XPath Injection",
    "description": "An attacker can craft special user-controllable input consisting of XPath expressions to inject the XML database and bypass authentication\n                  or glean information that he normally would not be able to. XPath Injection enables an attacker to talk directly to the XML database, \n                  thus bypassing the application completely. XPath Injection results from the failure of an application to properly sanitize input used as \n                  part of dynamic XPath expressions used to query an XML database.",
    "external_references": [
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/83.html",
            "external_id": "CAPEC-83"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/91.html",
            "external_id": "CWE-91"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/74.html",
            "external_id": "CWE-74"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/20.html",
            "external_id": "CWE-20"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/390.html",
            "external_id": "CWE-390"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/713.html",
            "external_id": "CWE-713"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/707.html",
            "external_id": "CWE-707"
        }
    ],
    "object_marking_refs": [
        "marking-definition--068ab041-90bb-4e30-9394-d306c62765a6"
    ],
    "x_capec_abstraction": "Detailed",
    "x_capec_example_instances": [
        "Consider an application that uses an XML database to authenticate its users. The application retrieves the user name and password from a request and forms an XPath expression to query the database. An attacker can successfully bypass authentication and login without valid credentials through XPath Injection. This can be achieved by injecting the query to the XML database with XPath syntax that causes the authentication check to fail. Improper validation of user-controllable input and use of a non-parameterized XPath expression enable the attacker to inject an XPath expression that causes authentication bypass."
    ],
    "x_capec_likelihood_of_attack": "High",
    "x_capec_prerequisites": [
        "XPath queries used to retrieve information stored in XML documents",
        "User-controllable input not properly sanitized before being used as part of XPath queries"
    ],
    "x_capec_skills_required": {
        "XPath Injection shares the same basic premises with SQL Injection. An attacker must have knowledge of XPath syntax and constructs in order to successfully leverage XPath Injection": "Low"
    },
    "x_capec_typical_severity": "High",
    "x_resources_required": "None: No specialized resources are required to execute this type of attack."
}