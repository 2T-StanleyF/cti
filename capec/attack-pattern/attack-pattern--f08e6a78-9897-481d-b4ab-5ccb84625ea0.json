{
    "type": "attack-pattern",
    "id": "attack-pattern--f08e6a78-9897-481d-b4ab-5ccb84625ea0",
    "created_by_ref": "identity--d922e967-ff9b-4f27-97e6-2fc5f54aac51",
    "created": "2018-03-05T19:06:11.814Z",
    "modified": "2018-03-05T19:06:11.814Z",
    "name": "Manipulating User State",
    "description": "The adversary modifies state information maintained by the target software in user-accessible locations. If successful, the target software will use this tainted state information and execute in an unintended manner. State management is an important function within an application. User state maintained by the application can include usernames, payment information, browsing history as well as application-specific contents such as items in a shopping cart. Manipulating user state can be employed by an adversary to elevate privilege, conduct fraudulent transactions or otherwise modify the flow of the application to derive certain benefits.",
    "external_references": [
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/74.html",
            "external_id": "CAPEC-74"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/372.html",
            "external_id": "CWE-372"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/371.html",
            "external_id": "CWE-371"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/315.html",
            "external_id": "CWE-315"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/353.html",
            "external_id": "CWE-353"
        },
        {
            "source_name": "cwe",
            "url": "http://cwe.mitre.org/data/definitions/693.html",
            "external_id": "CWE-693"
        }
    ],
    "object_marking_refs": [
        "marking-definition--068ab041-90bb-4e30-9394-d306c62765a6"
    ],
    "x_capec_abstraction": "Meta",
    "x_capec_example_instances": [
        "During the authentication process, an application stores the authentication decision (auth=0/1) in unencrypted cookies. At every request, this cookie is checked to permit or deny a request.\nAn adversary can easily violate this representation of user state and set auth=1 at every request in order to gain illegitimate access and elevated privilege in the application."
    ],
    "x_capec_likelihood_of_attack": "Medium",
    "x_capec_prerequisites": [
        "User state is maintained at least in some way in user-controllable locations, such as cookies or URL parameters."
    ],
    "x_capec_skills_required": {
        "The adversary needs to have knowledge of state management as employed by the target application, and also the ability to manipulate the state in a meaningful way.": "Medium"
    },
    "x_capec_typical_severity": "High",
    "x_resources_required": "The adversary needs a data tampering tool capable of generating and creating custom inputs to aid in the attack, like Fiddler, Wireshark, or a similar in-browser plugin (e.g., Tamper Data for Firefox)."
}